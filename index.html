<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>AURA | Discipline Engine</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&family=JetBrains+Mono:wght@300;500&display=swap" rel="stylesheet">
    <style>
        :root {
            /* Palette Tech Gray Pilihan */
            --bg: #1F2328;             
            --card-bg: #2F343A;        
            --border: #394049;         
            --input-bg: #1F2328;       
            --text-main: #E5E7EB;      
            --text-dim: #8A8F94;       
            --blue: #5F6B75;           
            --red: #fb7185;
            --green: #4ade80;
            --gold: #fbbf24;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Inter', sans-serif; -webkit-font-smoothing: antialiased; }
        body { background: var(--bg); color: var(--text-main); height: 100vh; width: 100vw; overflow: hidden; touch-action: manipulation; }

        /* --- UI COMPONENTS --- */
        .nav-bar { position: fixed; top: 16px; left: 50%; transform: translateX(-50%); z-index: 1000; background: var(--card-bg); padding: 4px; border-radius: 20px; border: 1px solid var(--border); display: flex; gap: 4px; }
        .nav-btn { padding: 8px 18px; border-radius: 16px; border: none; color: var(--text-dim); background: transparent; font-size: 0.7rem; font-weight: 700; cursor: pointer; transition: 0.2s; }
        .nav-btn.active { background: var(--text-main); color: var(--bg); }

        #trial-indicator { display: none; position: fixed; top: 70px; left: 50%; transform: translateX(-50%); background: var(--blue); color: white; padding: 4px 15px; border-radius: 12px; font-size: 0.6rem; font-weight: 800; z-index: 999; letter-spacing: 1px; box-shadow: 0 4px 15px rgba(0,0,0,0.3); }

        .app-shell { height: 100vh; overflow-y: auto; padding: 100px 16px 40px; max-width: 420px; margin: 0 auto; display: flex; flex-direction: column; gap: 12px; }
        .card { width: 100%; background: var(--card-bg); border: 1px solid var(--border); border-radius: 24px; padding: 22px; transition: 0.3s; }
        
        /* State Mode */
        .free-active #stats-card, .free-active #logs-panel, .free-active #sound-section { opacity: 0.15; pointer-events: none; filter: grayscale(1); }
        
        .stat-row { display: flex; justify-content: space-between; align-items: center; padding: 6px 0; }
        .stat-label { font-size: 0.55rem; font-weight: 800; color: var(--text-dim); letter-spacing: 1.5px; }
        .stat-val { font-family: 'JetBrains Mono'; font-size: 0.8rem; font-weight: 500; }

        #timer-display { font-family: 'JetBrains Mono'; font-size: 3.5rem; font-weight: 300; letter-spacing: -2px; text-align: center; padding: 20px 0; color: var(--text-main); transition: 0.4s; }
        .running #timer-display { color: var(--text-dim); font-size: 2.5rem; }

        .task-input { width: 100%; background: var(--input-bg); border: 1px solid var(--border); border-radius: 16px; padding: 16px; color: white; text-align: center; font-size: 0.85rem; margin-bottom: 15px; outline: none; }
        .task-input:disabled { opacity: 0.5; border-style: dashed; }

        .time-picker { display: flex; gap: 8px; margin-bottom: 16px; }
        .picker-group { flex: 1; text-align: center; }
        .picker-group label { font-size: 0.5rem; color: var(--text-dim); display: block; margin-bottom: 5px; }
        .picker-group input { width: 100%; background: var(--input-bg); border: 1px solid var(--border); border-radius: 12px; padding: 12px 4px; color: white; text-align: center; font-family: 'JetBrains Mono'; outline: none; border: 1px solid transparent; }

        .btn-main { width: 100%; padding: 18px; border-radius: 20px; border: none; font-size: 0.8rem; font-weight: 800; background: var(--text-main); color: var(--bg); cursor: pointer; transition: 0.2s; }
        .btn-main:active { transform: scale(0.96); }
        .controls-secondary { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 10px; }
        .btn-sub { padding: 12px; border-radius: 14px; border: 1px solid var(--border); background: transparent; color: var(--text-dim); font-size: 0.65rem; font-weight: 700; cursor: pointer; }

        /* --- SOUNDSCAPE --- */
        #sound-section { margin-top: 15px; padding-top: 15px; border-top: 1px solid var(--border); }
        .sound-selector { display: flex; gap: 8px; overflow-x: auto; padding: 10px 0; scrollbar-width: none; }
        .sound-chip { padding: 8px 16px; border-radius: 20px; border: 1px solid var(--border); font-size: 0.6rem; color: var(--text-dim); white-space: nowrap; cursor: pointer; }
        .sound-chip.active { background: var(--text-main); color: var(--bg); border-color: var(--text-main); }

        /* --- LOGS --- */
        #log-content { margin-top: 15px; display: flex; flex-direction: column; gap: 10px; }
        .log-item { background: rgba(0,0,0,0.1); padding: 12px; border-radius: 16px; border-left: 3px solid var(--border); }
        .log-item.st-tuntas { border-left-color: var(--green); }
        .log-item.st-batal { border-left-color: var(--red); }
        .log-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 4px; }
        .status-pill { font-size: 0.5rem; padding: 2px 8px; border-radius: 5px; font-weight: 900; }
        .pill-tuntas { background: var(--green); color: black; }
        .pill-batal { background: var(--red); color: white; }

        /* --- OVERLAYS --- */
        .overlay { position: fixed; inset: 0; background: var(--bg); z-index: 5000; display: none; flex-direction: column; align-items: center; justify-content: center; text-align: center; padding: 40px; }
        #intro-overlay { display: flex; background: rgba(31, 35, 40, 0.98); backdrop-filter: blur(10px); }
        #intro-modal { background: var(--card-bg); border: 1px solid var(--border); border-radius: 32px; width: 100%; max-width: 340px; padding: 32px 24px; }
        .modal-header h2 { font-size: 1.4rem; font-weight: 800; letter-spacing: 2px; margin-bottom: 5px; }
        .price-tag { font-size: 0.7rem; color: var(--text-main); background: var(--border); padding: 4px 14px; border-radius: 20px; display: inline-block; margin-bottom: 25px; }
        .feat-line { display: flex; gap: 12px; margin-bottom: 15px; text-align: left; align-items: center; }
    </style>
</head>
<body class="free-active">

    <div id="intro-overlay" class="overlay">
        <div id="intro-modal">
            <div class="modal-header">
                <h2>AURA PRO</h2>
                <div class="price-tag">Rp 15.000 / Sekali Bayar</div>
            </div>
            
            <div style="margin-bottom: 25px;">
                <div class="feat-line"><span>üìú</span><div style="font-size:0.7rem;"><b>Memori Keputusan:</b> Catat riwayat fokusmu secara permanen.</div></div>
                <div class="feat-line"><span>üîí</span><div style="font-size:0.7rem;"><b>Lock-In Mode:</b> Input niat dikunci pas mulai sesi.</div></div>
                <div class="feat-line"><span>üéß</span><div style="font-size:0.7rem;"><b>Vibe Mahasiswa:</b> Akses Alpha Waves & Cafe Malam.</div></div>
            </div>

            <button class="btn-main" style="margin-bottom: 10px;" onclick="buyPro()">BELI AKSES SELAMANYA</button>
            <button class="btn-sub" style="width: 100%; border-color: var(--blue); color: var(--blue);" onclick="startTrial()">COBA PRO (30 MENIT)</button>
            <button class="btn-sub" style="border: none; width: 100%; margin-top: 10px; font-size: 0.6rem;" onclick="enterApp('free')">Lanjut Mode Gratis</button>
        </div>
    </div>

    <div id="trial-indicator">MODE COBA-COBA: <span id="trial-timer">30:00</span></div>

    <nav class="nav-bar">
        <button class="nav-btn active" id="nav-free" onclick="setPlan('free', this)">GRATIS</button>
        <button class="nav-btn" id="nav-pro" onclick="requestProAccess()">PRO üíé</button>
    </nav>

    <div id="ritual-overlay" class="overlay">
        <p style="font-size: 0.6rem; letter-spacing: 5px; color: var(--text-dim); margin-bottom: 15px;">SET NIAT DULU</p>
        <div id="ritual-count" style="font-family:'JetBrains Mono'; font-size:5rem; font-weight:300;">3</div>
    </div>

    <div id="surrender-overlay" class="overlay">
        <p style="color: var(--red); font-weight: 800; margin-bottom: 20px; letter-spacing: 3px; font-size: 0.8rem;">üè≥Ô∏è MENYERAH?</p>
        <p style="font-size: 0.85rem; margin-bottom: 40px; color: var(--text-dim); line-height: 1.6; max-width: 260px;">Keputusan berhenti akan dicatat sebagai kegagalan fokus hari ini.</p>
        <div style="display:flex; flex-direction: column; gap: 12px; width: 100%; max-width: 250px;">
            <button class="btn-main" onclick="cancelSurrender()">GAS LAGI</button>
            <button class="btn-sub" onclick="confirmSurrender()" style="color: var(--red); border-color: var(--red);">AKHIRI & CATAT BATAL</button>
        </div>
    </div>

    <div class="app-shell">
        <div id="stats-card" class="card">
            <div class="stat-row"><span class="stat-label">STATUS HARI INI</span><span id="continuity-val" class="stat-val">JEDA</span></div>
            <div class="stat-row"><span class="stat-label">SESI TUNTAS</span><span id="total-done" class="stat-val">0</span></div>
        </div>

        <main class="card">
            <div id="timer-display">00:00:00</div>
            <input type="text" id="task-input" class="task-input" placeholder="Apa fokus utamamu?">
            
            <div id="sound-section">
                <span class="stat-label">SUASANA</span>
                <div class="sound-selector">
                    <div class="sound-chip active" onclick="setSound('none', this)">Hening</div>
                    <div class="sound-chip" onclick="setSound('white', this)">White Noise</div>
                    <div class="sound-chip" onclick="setSound('rain', this)">Hujan</div>
                    <div class="sound-chip" onclick="setSound('alpha', this)">Alpha Waves üíé</div>
                </div>
            </div>

            <div class="time-picker" id="time-picker">
                <div class="picker-group"><label>JAM</label><input type="number" id="h" value="0"></div>
                <div class="picker-group"><label>MENIT</label><input type="number" id="m" value="25"></div>
                <div class="picker-group"><label>DETIK</label><input type="number" id="s" value="0"></div>
            </div>
            
            <button class="btn-main" id="start-btn" onclick="initStart()">MULAI SESI</button>
            <div class="controls-secondary">
                <button class="btn-sub" onclick="handlePause()" id="pause-btn">JEDA</button>
                <button class="btn-sub" onclick="requestSurrender()">STOP</button>
            </div>
        </main>

        <div id="logs-panel" class="card">
            <span class="stat-label">MEMORI KEPUTUSAN</span>
            <div id="log-content"></div>
        </div>
    </div>

    <script>
        let timeLeft = 0, timer = null, mode = 'free', isPaused = false;
        let trialActive = false, trialTime = 1800, activeTask = "";

        // MODE HANDLERS
        function requestProAccess() { if(!trialActive && mode !== 'pro') document.getElementById('intro-overlay').style.display = 'flex'; }
        
        function enterApp(p) { 
            document.getElementById('intro-overlay').style.display = 'none'; 
            setPlan(p, document.getElementById('nav-' + p)); 
        }

        function setPlan(p, btn) {
            mode = p;
            document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
            document.body.className = p + '-active';
            resetToFresh();
            renderLogs();
        }

        function startTrial() {
            trialActive = true;
            document.getElementById('intro-overlay').style.display = 'none';
            document.getElementById('trial-indicator').style.display = 'block';
            setPlan('pro', document.getElementById('nav-pro'));
            
            const tInt = setInterval(() => {
                trialTime--;
                let m = Math.floor(trialTime / 60), s = trialTime % 60;
                document.getElementById('trial-timer').innerText = `${m}:${s.toString().padStart(2, '0')}`;
                if(trialTime <= 0) {
                    clearInterval(tInt);
                    trialActive = false;
                    document.getElementById('trial-indicator').style.display = 'none';
                    setPlan('free', document.getElementById('nav-free'));
                    alert("Waktu coba-coba habis!");
                }
            }, 1000);
        }

        function buyPro() { alert("Simulasi: Pembayaran Rp 15.000 Berhasil!"); enterApp('pro'); }

        // TIMER LOGIC
        function initStart() {
            const h = parseInt(document.getElementById('h').value) || 0, m = parseInt(document.getElementById('m').value) || 0, s = parseInt(document.getElementById('s').value) || 0;
            timeLeft = (h * 3600) + (m * 60) + s;
            activeTask = document.getElementById('task-input').value || "Sesi Fokus Tanpa Nama";
            if(timeLeft <= 0) return;

            if(mode === 'pro') {
                document.getElementById('ritual-overlay').style.display = 'flex';
                let c = 3;
                const rInt = setInterval(() => {
                    c--; document.getElementById('ritual-count').innerText = c;
                    if(c <= 0) { clearInterval(rInt); document.getElementById('ritual-overlay').style.display = 'none'; startTimer(); }
                }, 1000);
            } else startTimer();
        }

        function startTimer() {
            document.body.classList.add('running');
            document.getElementById('start-btn').style.display = 'none';
            document.getElementById('time-picker').style.display = 'none';
            document.getElementById('task-input').disabled = (mode === 'pro');

            timer = setInterval(() => {
                if(!isPaused && timeLeft > 0) { timeLeft--; updateUI(); }
                else if(timeLeft <= 0) finishSession();
            }, 1000);
        }

        function updateUI() {
            const h = Math.floor(timeLeft / 3600).toString().padStart(2, '0'), m = Math.floor((timeLeft % 3600) / 60).toString().padStart(2, '0'), s = (timeLeft % 60).toString().padStart(2, '0');
            document.getElementById('timer-display').innerText = `${h}:${m}:${s}`;
        }

        function finishSession() {
            if(mode === 'pro') { saveLog(activeTask, "TUNTAS"); updateContinuity("UTUH"); }
            alert("Sesi Selesai!");
            resetToFresh();
        }

        function requestSurrender() { 
            if(!timer) return;
            if(mode === 'free') resetToFresh();
            else document.getElementById('surrender-overlay').style.display = 'flex';
        }

        function confirmSurrender() {
            document.getElementById('surrender-overlay').style.display = 'none';
            saveLog(activeTask, "BATAL");
            updateContinuity("HANCUR");
            resetToFresh();
        }

        function cancelSurrender() { document.getElementById('surrender-overlay').style.display = 'none'; }
        
        function handlePause() {
            isPaused = !isPaused;
            document.getElementById('pause-btn').innerText = isPaused ? "LANJUT" : "JEDA";
        }

        function resetToFresh() {
            clearInterval(timer); timer = null; isPaused = false;
            document.body.classList.remove('running');
            document.getElementById('start-btn').style.display = 'block';
            document.getElementById('time-picker').style.display = 'flex';
            document.getElementById('task-input').disabled = false;
            updateUI();
        }

        // LOGGING SYSTEM
        function saveLog(task, status) {
            let logs = JSON.parse(localStorage.getItem('aura_logs') || '[]');
            logs.unshift({ task, status, time: new Date().toLocaleTimeString([], {hour:'2-digit', minute:'2-digit'}) });
            localStorage.setItem('aura_logs', JSON.stringify(logs.slice(0, 10)));
            renderLogs();
        }

        function renderLogs() {
            const logs = JSON.parse(localStorage.getItem('aura_logs') || '[]');
            document.getElementById('total-done').innerText = logs.filter(l => l.status === "TUNTAS").length;
            document.getElementById('log-content').innerHTML = logs.map(l => `
                <div class="log-item st-${l.status.toLowerCase()}">
                    <div class="log-header">
                        <span style="font-weight:700; font-size:0.75rem;">${l.task}</span>
                        <span class="status-pill pill-${l.status.toLowerCase()}">${l.status}</span>
                    </div>
                    <div style="font-size:0.6rem; color:var(--text-dim);">${l.time}</div>
                </div>
            `).join('') || '<p style="color:var(--border); text-align:center; font-size:0.7rem; padding:10px;">Belum ada jejak.</p>';
        }

        function updateContinuity(val) {
            document.getElementById('continuity-val').innerText = val;
            document.getElementById('continuity-val').style.color = val === "UTUH" ? "var(--green)" : "var(--red)";
        }

        function setSound(type, btn) {
            document.querySelectorAll('.sound-chip').forEach(c => c.classList.remove('active'));
            btn.classList.add('active');
            // Audio logic can be added here
        }

        renderLogs();
    </script>
</body>
</html>
